{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/main.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/@fullcalendar/core/main.min.css" rel="stylesheet" />
    <script src="https://unpkg.com/fullcalendar@5.10.1/main.min.js"></script>
    
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Include FullCalendar JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/5.10.1/main.min.js"></script>
   
</head>
<style>
#calendar {
    width: 900px; /* Set the width of the calendar */
    height: 500px; /* Set the height of the calendar */
}

.fc-day {
    padding: 5px; /* Adjust padding to make day cells smaller */
    font-size: 15px; /* Adjust font size to make text smaller */
}

.red-text{
   color: red !important;
   height: 20px;
}

.btn1{
  background-color: green !important;
}
</style>
<body>
    <h3>This is faculty Home</h3>
    {% if student_data %}
      {% for x in student_data %}
       <h3>{{ x.student_name }}</h3>
       <div id="calendar-{{ x.student_registration_id }}" style="width: 600px; height: 500px;"></div>
     
       <script>
       document.addEventListener('DOMContentLoaded', function() {
           var calendarEl = document.getElementById('calendar-{{ x.student_registration_id }}');
           var calendar = new FullCalendar.Calendar(calendarEl, {
               initialView: 'dayGridMonth',
               events: [
                   {
                       title: 'Event 1',
                       start: '2024-05-01',
                       end: '2024-05-02'
                   },
                   {
                       title: 'Event 2',
                       start: '2024-05-05'
                   }
               ],
               dayCellDidMount: function(info) {
                   var radio1 = document.createElement('input');
                   radio1.type = 'radio';
                   radio1.name = 'radio_' + info.date.toISOString();
                   radio1.value = 'Present';
                   radio1.id = 'present_' + info.date.toISOString();
                   var label1 = document.createElement('label');
                   label1.innerHTML = 'Present';
                   label1.htmlFor = 'present_' + info.date.toISOString();

                   var radio2 = document.createElement('input');
                   radio2.type = 'radio';
                   radio2.name = 'radio_' + info.date.toISOString();
                   radio2.value = 'Absent';
                   radio2.id = 'absent_' + info.date.toISOString();
                   var label2 = document.createElement('label');
                   label2.innerHTML = 'Absent';
                   label2.htmlFor = 'absent_' + info.date.toISOString();

                   info.el.appendChild(radio1);
                   info.el.appendChild(label1);
                   info.el.appendChild(radio2);
                   info.el.appendChild(label2);

                   radio1.addEventListener('change', function() {
                       if (this.checked) {
                           radio1.classList.add('btn1')
                       } else {
                           radio1.classList.remove('btn1')
                       }
                   });

                   radio2.addEventListener('change', function() {
                       if (this.checked) {
                           radio2.classList.add('btn1')
                       } else {
                           radio2.classList.remove('btn1')
                       }
                   });
               }
           });
           calendar.render();
       });
    </script>
      {% endfor %}
    {% endif %}

    <button type="submit" id="submitBtn">Submit</button>
    <a href="{% url 'attendance_report' id_of_attendence=id_of_attendence %}">attendance report </a>
    <script>
        // Add event listener to submit button
        $('#submitBtn').on('click', function() {
            var selectedDate = $('input[type="radio"]:checked').attr('name').replace('radio_', '');
            var selectedValue = $('input[name="radio_' + selectedDate + '"]:checked').val();
            var csrfToken = '{{ csrf_token }}';
    
            $.ajax({
                type: 'POST',
                url: "{% url 'attendance' %}",
                data: {
                    'csrfmiddlewaretoken': csrfToken,
                    'date': selectedDate,
                    'value': selectedValue
                },
                success: function(response) {
                    console.log(response);
                },
                error: function(xhr, status, error) {
                    console.error(xhr.responseText);
                }
            });
        });
        </script>
</body>
</html>
