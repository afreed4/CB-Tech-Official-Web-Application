
{% extends 'staff_template/base_template.html' %}

{% block page_title %}
    Edit Enquiry | #ID : {{ id }}
{% endblock page_title %}

{% block main_content %}

{% load static %}
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/main.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/@fullcalendar/core/main.min.css" rel="stylesheet" />
    <script src="https://unpkg.com/fullcalendar@5.10.1/main.min.js"></script>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<!-- Include FullCalendar JavaScript -->
   <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/5.10.1/main.min.js"></script>
</head>
<style>
    #calendar {
        width: 990px; /* Set the width of the calendar */
        height: 500px; /* Set the height of the calendar */
        margin-left: 60px;
    }
    
    .fc-day {
        padding: 15px; /* Adjust padding to make day cells smaller */
        font-size: 15px; /* Adjust font size to make text smaller */
    }
    
    .red-text{
       color: red !important;
       height: 20px;
    }
    
    .btn1{
      background-color: green !important;
    }
</style>
<body>
<section class="content">
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-12">
                    <!-- general form elements -->
                    
                    <div class="card card-primary">
                        <div class="card-header">
                            <h3 class="card-title">Attendance</h3>
                    </div>
                    <div id="calendar"></div>
                    </div>
                    <button type="submit" id="submitBtn" class="btn btn-primary"><a href="{% url 'take_attendance' id %}"></a>Take Attendance</button>
                    <p>{{ context.id_of_attendance }}</p>
                    
                    {% if result %}
                     {{ result.id_of_attendance }}
                     {% endif %}
                    <a href="{% url 'attendance_report' id %}">Check Attendance</a>

                    <br><br>
                    <div class="card card-primary">
                        <div class="card-header">
                            <h3 class="card-title">Edit Enquiry</h3>
                        </div>
                        <!-- /.card-header -->
                        <!-- form start -->
                        {% comment %} Displaying the Django Form using forms.py EditenquiryForm {% endcomment %}
                        {% url 'staff_edit_enquiry_save' enquiry_id=id as action_paths %}
                        {% include 'staff_template/form_template.html' with messages=messages form=form action_path=action_paths button_text="Update Enquiry" %}
                   
                    </div>
                    <!-- /.card -->

                </div>
            </div>
           
<script>
  document.addEventListener('DOMContentLoaded', function() {
    var calendarEl = document.getElementById('calendar');
    var calendar = new FullCalendar.Calendar(calendarEl, {
        // Your options here
        initialView: 'dayGridMonth', // Example view
        events: [
            // Example events
            {
                title: 'Event 1',
                start: '2024-05-01',
                end: '2024-05-02'
            },
            {
                title: 'Event 2',
                start: '2024-05-05'
            }
        ],
        dayCellDidMount: function(info) {
            // Create radio buttons
            var radio1 = document.createElement('input');
            radio1.type = 'radio';
            radio1.name = 'radio_' + info.date.toISOString(); // Unique name for each day
            radio1.value = 'Present';
            radio1.id = 'present_' + info.date.toISOString(); // Unique id for each button
            var label1 = document.createElement('label');
            label1.innerHTML = 'Present';
            label1.htmlFor = 'present_' + info.date.toISOString();

            var radio2 = document.createElement('input');
            radio2.type = 'radio';
            radio2.name = 'radio_' + info.date.toISOString(); // Same name as radio1
            radio2.value = 'Absent';
            radio2.id = 'absent_' + info.date.toISOString(); // Unique id for each button
            var label2 = document.createElement('label');
            label2.innerHTML = 'Absent';
            label2.htmlFor = 'absent_' + info.date.toISOString();

            // Append radio buttons to the day cell
            info.el.appendChild(radio1);
            info.el.appendChild(label1);
            info.el.appendChild(radio2);
            info.el.appendChild(label2);

            // Add event listeners to radio buttons
            radio1.addEventListener('click', function() {
                if(this.checked){
                    this.classList.add('btn1')
                }else{
                    this.classList.remove('btn1')
                }
                
            });

            radio2.addEventListener('click', function() {
                console.log('Absent button clicked');
            });
        }
    });
    calendar.render();
});

    </script>

<script>
    // Add event listener to submit button
    $('#submitBtn').on('click', function() {
        var selectedDate = $('input[type="radio"]:checked').attr('name').replace('radio_', '');
        var selectedValue = $('input[name="radio_' + selectedDate + '"]:checked').val();
        var csrfToken = '{{ csrf_token }}';

        $.ajax({
            type: 'POST',
            url: "{% url 'take_attendance' id %}",
            data: {
                'csrfmiddlewaretoken': csrfToken,
                'date': selectedDate,
                'value': selectedValue
            },
            success: function(response) {
                console.log(response);
            },
            error: function(xhr, status, error) {
                console.error(xhr.responseText);
            }
        });
    });
    </script>

        </div><!-- /.container-fluid -->
      </section>


  {% endblock main_content %}

</body>
</html>